insert into "clans" ("clantag","clanname","active") values
('20V8V8Y9G','Air Hounds 5',true),
('20YUYRVCQ','FarmWarKings',true),
('220LVLVLQ','INDO POSEIDON 2',true),
('22GGGGVYR','LEADER-[OF]-WAR',true),
('22LRRCJ00','HITMAN-REBORN',true),
('280P00J8P','BANGLADESH',true),
('288UJCGJG','Unleash Wrath™',true),
('28J0PGL8','PINOY PLAYHOUSE',true),
('29Y2P092P','TrapNation♠️',true),
('2L2QVURQ8','Req and Leave',true),
('2L88QPP9','Barching Crazy™',true),
('2LR200YP','west java',true),
('2P9UG82L','Air Hounds 3',true),
('2PLL9VV89','HERO HINDUTVA ™',true),
('2PLQYQYGC','ARIKANAMI',true),
('2PVC9LY2L','Barching Mad™01',true),
('808PJCG8','PNOY UNDRGROUND',true),
('80Y0UVYJ','ItalianClashers',true),
('82282YGV','RANTAU comunity',true),
('888R2J','KaligangsaTegal',true),
('89GPPCV','Adult No CWs 11',true),
('89R0Q2U9','al fatha',true),
('8G80YGV0','Reunified',true),
('8JL9PLUC','PINOY PLAYHOUSE',true),
('8P9GGGL0','awan clan`s',true),
('8PQ90L90','KNN UNITED',true),
('8QU8J9LP','Air Hounds',true),
('8UUYQ92L','$$$WaR-GoDz$$$',true),
('8VQUJQCC','Indian Army',true),
('8VY9G80Y','Indo Legends',true),
('9CG9VLVY','S.T.B Clan',true),
('9CPJY02R','Brown Lemonade',true),
('9J9LUPGC','TaMiL ToRnAdOs',true),
('9PUUYGJU','无尽梦想Ⅴ',true),
('9QQ8GR20','REQ & LEAVE .IR',true),
('9UJV8J0Y','KINGS LANDING',true),
('C0LCJVV2','INDO POSEIDON',true),
('CQVQV22C','Gujarat Pearl',true),
('G088G2UQ','INDO CREATIVE02',true),
('G0UY98U0','AuroraIND',true),
('G28VLR89','Neo Legends',true),
('G2YJ28RJ','Before Ice',true),
('G9CCUC0V','~LootAddicts~',true),
('GGJYVPVJ','ArNold FiGo',true),
('J0QYPCRJ','BREAK THE RuleS',true),
('JQ229YGJ','Air Hounds 4',true),
('JU089Y9','Amaranth',true),
('L82VCJYY','War Snipers 2.F',true),
('L8VU8V90','Reunified Farm',true),
('L99PC88L','COMILLA BSTFRND',true),
('LGC0P0JY','شعله 1',true),
('LUY2C9RJ','COOL BROS 1',true),
('LVVRGV9G','SuRgIcAl StRiKe',true),
('P09U22Q2','BLUE DRAGON PH',true),
('P99CRYU2','Barching Mad™',true),
('P9QJV2R9','ClashHeads(FR)2',true),
('PQRLRQP0','KOROSH SOLDIERS',true),
('PURQ8VYL','Kerala',true),
('QPRLQVQY','iran64',true),
('QVQLG08V','Dynamic Lance',true),
('RGU2GJU0','DeatH ZonE#803',true),
('UC9GQL0','JAI HO',true),
('VGCGR8UR','*|FoRBiDDeN|*jr',true),
('Y9JQGQVY','NAGA BROTHERS',true),
('YGCLURPQ','TANGKI MADU CPU',true),
('YQJ8YYGY','SgFighters',true),
('YRYJQYG2','Cool Bros',true),
('YUY92U2R','eX*|FoRBiDDeN|*',true),
('YVVCC92G','Air Hounds 2',true),
('YYC2J2VP','Droopy®Raiders',true),
('YYJQUL8P','ROYAL INDAIN 4',true);

insert into transactions (clantag, ts, pubnote, points, reason) values 
('20V8V8Y9G', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('20YUYRVCQ', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('220LVLVLQ', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('22GGGGVYR', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('22LRRCJ00', '20220220T090000.000Z', 'Imported point value 6', 6, 'import'),
('280P00J8P', '20220220T090000.000Z', 'Imported point value -3', -3, 'import'),
('28J0PGL8', '20220220T090000.000Z', 'Imported point value 2', 2, 'import'),
('29Y2P092P', '20220220T090000.000Z', 'Imported point value 2', 2, 'import'),
('2L2QVURQ8', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('2L88QPP9', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('2LR200YP', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('2P9UG82L', '20220220T090000.000Z', 'Imported point value -3', -3, 'import'),
('2PLL9VV89', '20220220T090000.000Z', 'Imported point value -2', -2, 'import'),
('2PLQYQYGC', '20220220T090000.000Z', 'Imported point value 2', 2, 'import'),
('2PVC9LY2L', '20220220T090000.000Z', 'Imported point value -2', -2, 'import'),
('808PJCG8', '20220220T090000.000Z', 'Imported point value 2', 2, 'import'),
('80Y0UVYJ', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('82282YGV', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('888R2J', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('89GPPCV', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('89R0Q2U9', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('8G80YGV0', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('8JL9PLUC', '20220220T090000.000Z', 'Imported point value 2', 2, 'import'),
('8P9GGGL0', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('8PQ90L90', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('8QU8J9LP', '20220220T090000.000Z', 'Imported point value 2', 2, 'import'),
('8UUYQ92L', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('8VQUJQCC', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('8VY9G80Y', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('9CG9VLVY', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('9CPJY02R', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('9J9LUPGC', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('9PUUYGJU', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('9QQ8GR20', '20220220T090000.000Z', 'Imported point value 2', 2, 'import'),
('9UJV8J0Y', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('C0LCJVV2', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('CQVQV22C', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('G088G2UQ', '20220220T090000.000Z', 'Imported point value 3', 3, 'import'),
('G0UY98U0', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('G28VLR89', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('G2YJ28RJ', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('G9CCUC0V', '20220220T090000.000Z', 'Imported point value 2', 2, 'import'),
('GGJYVPVJ', '20220220T090000.000Z', 'Imported point value -2', -2, 'import'),
('J0QYPCRJ', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('JQ229YGJ', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('JU089Y9', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('L82VCJYY', '20220220T090000.000Z', 'Imported point value 6', 6, 'import'),
('L8VU8V90', '20220220T090000.000Z', 'Imported point value -2', -2, 'import'),
('L99PC88L', '20220220T090000.000Z', 'Imported point value 8', 8, 'import'),
('LGC0P0JY', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('LUY2C9RJ', '20220220T090000.000Z', 'Imported point value 3', 3, 'import'),
('LVVRGV9G', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('P09U22Q2', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('P99CRYU2', '20220220T090000.000Z', 'Imported point value -4', -4, 'import'),
('P9QJV2R9', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('PQRLRQP0', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('PURQ8VYL', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('QPRLQVQY', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('QVQLG08V', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('RGU2GJU0', '20220220T090000.000Z', 'Imported point value 3', 3, 'import'),
('UC9GQL0', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('VGCGR8UR', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('Y9JQGQVY', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('YGCLURPQ', '20220220T090000.000Z', 'Imported point value 1', 1, 'import'),
('YQJ8YYGY', '20220220T090000.000Z', 'Imported point value -3', -3, 'import'),
('YRYJQYG2', '20220220T090000.000Z', 'Imported point value -9', -9, 'import'),
('YUY92U2R', '20220220T090000.000Z', 'Imported point value -1', -1, 'import'),
('YVVCC92G', '20220220T090000.000Z', 'Imported point value 0', 0, 'import'),
('YYC2J2VP', '20220220T090000.000Z', 'Imported point value -3', -3, 'import'),
('YYJQUL8P', '20220220T090000.000Z', 'Imported point value 1', 1, 'import');

update clans set points=x.pts from (select clantag, sum(points) as pts from transactions where deleted=false group by clantag) as x where clans.clantag=x.clantag returning null;
